---
import { capitalize } from "@/libraries/utils";

const { crumbs } = Astro.props;

interface Crumb {
  label: string;
  href: string;
}

interface Props {
  crumbs: Crumb[];
}
---

<nav class="w-full max-w-[1400px] mx-auto md:text-xl text-left px-6 md:px-12 lg:px-20 mt-4">
  <ul class="flex flex-row gap-2" id="breadcrumb-list">
    {
      crumbs.map((crumb, index) => (
        <li class="flex gap-1 items-center py-10">
          {index < crumbs.length - 1 ? (
            <>
              <a class="text-secondary hover:text-current focus:text-current text__glowing transition-colors" href={crumb.href}>
                {capitalize(crumb.label)}
              </a>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="m9 18 6-6-6-6" />
              </svg>
            </>
          ) : (
            <>
              <a class="text-secondary hover:text-current focus:text-current text__glowing transition-colors" href={crumb.href}>
                {capitalize(crumb.label)}
              </a>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                id="last-separator"
              >
                <path d="m9 18 6-6-6-6" />
              </svg>
              <span class="line-clamp-1 text__glowing" id="page-title-breadcrumb"></span>
            </>
          )}
        </li>
      ))
    }
  </ul>
</nav>

<script>
  // Buscar el h1 de la p√°gina y agregarlo al breadcrumb
  const h1Element = document.querySelector('h1');
  const breadcrumbTitle = document.getElementById('page-title-breadcrumb');
  
  if (h1Element && breadcrumbTitle) {
    const title = h1Element.textContent || '';
    breadcrumbTitle.textContent = title;
    breadcrumbTitle.setAttribute('title', title);
  } else if (breadcrumbTitle && !h1Element) {
    // Si no hay h1, ocultar el separador y el span
    const lastSeparator = document.getElementById('last-separator');
    if (lastSeparator) lastSeparator.style.display = 'none';
    breadcrumbTitle.style.display = 'none';
  }
</script>
