---
import Button from "@/shared/components/Button.astro";
import Typography from "@/shared/components/ui/Typography.astro";
import {
  getI18N,
  getCurrentLocale,
  getCategoryByLanguage,
} from "@/shared/i18n";

interface Props {
  video: string;
  subtitle: string;
  title: string;
  text: string;
  textDos?: string;
  buttonUrl: string;
  buttonText: string;
  buttonTitle: string;
  language?: string;
}

const activeLanguage = Astro.currentLocale;

const i18n = getI18N({ language: activeLanguage });

const { video, subtitle, title, text, textDos, buttonUrl, buttonText, buttonTitle } = Astro.props;

function getTipeFromVideo() {
  const videoExtension = video.split(".").pop();
  if (videoExtension === "mp4") return "video/mp4";
  if (videoExtension === "webm") return "video/webm";
  return "video/mp4";
}

const type = getTipeFromVideo(); 

const features = [
  { 
    img: '/Strength.webp', 
    title: i18n.PAGES.CANOPIES.TITLE_IMG.TITLE_1,
    alt: i18n.PAGES.CANOPIES.TITLE_IMG.TITLE_1
  },
  { 
    img: '/High-technology.webp', 
    title: i18n.PAGES.CANOPIES.TITLE_IMG.TITLE_2,
    alt: i18n.PAGES.CANOPIES.TITLE_IMG.TITLE_2
  },
  { 
    img: '/Durability.webp', 
    title: i18n.PAGES.CANOPIES.TITLE_IMG.TITLE_3,
    alt: i18n.PAGES.CANOPIES.TITLE_IMG.TITLE_3
  }
];
---

<div class="flex flex-col md:flex-row bg-white">
  
  <div class="w-full md:w-1/2 px-4 md:px-12 py-12">
    {title && (
      <Typography
        tag="h2"
        type="black"
        className="text-center font-bold mb-12"
        text={title}
      />
    )}
    {text && (
      <Typography
        tag="div"
        type="black"
        className="text-center px-4 mb-12"
        text={text}
        responsive
      />
    )}
    {textDos && (
      <Typography
        tag="div"
        type="black"
        className="text-center px-4 mb-12"
        text={textDos}
        responsive
      />
    )}
    
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 max-w-5xl mx-auto mb-12 px-4">
      {features.map((feature) => (
        <div class="flex flex-col items-center text-center">
          <img 
            src={feature.img} 
            alt={feature.alt}
            class="w-full max-w-[180px] h-auto object-contain mb-4"
          />
          <Typography 
            tag="h3" 
            text={feature.title} 
            className="text-center font-semibold uppercase text-gray-800 text-sm sm:text-base lg:text-lg" 
          />
        </div>
      ))}
    </div>

    <div class="text-center">
      {buttonUrl && buttonText ? (
        <Button
          target="_self"
          url={buttonUrl}
          title={buttonTitle}
          color="black"
        >
          {buttonText}
        </Button>
      ) : null}
    </div>
  </div>

  <div class="relative w-full md:w-1/2 flex items-center justify-center mt-12 mb-12 ml-0 md:ml-12">
    <div class="bg-gradient-to-br from-[#315A75] via-[#151a36] to-[#151a36] w-full h-[250px] md:w-[800px] md:h-[550px] z-0"></div>

    <video
      autoplay
      loop
      muted
      playsinline
      preload="none"
      class="absolute w-[90%] h-[250px] md:left-[-40px] md:w-[700px] md:h-[450px] object-cover object-top brightness-50 z-10"
    >
      <source src={video} type={type} />
    </video>
  </div>
</div>
