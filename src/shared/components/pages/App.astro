---
import Layout from "@/shared/layouts/Layout.astro"
import Video from "@/shared/components/Video.astro"
import Button from "@/shared/components/Button.astro"
import SectionIntro from "@/shared/components/sections/SectionIntro.astro"
import SectionBento from "@/shared/components/sections/SectionBento.astro"
import SectionFactory from "@/shared/components/sections/SectionFactory.astro"
import SectionContact from "@/shared/components/sections/SectionContact.astro"
import SectionCourts from "@/shared/components/sections/SectionCourts.astro"
import SectionCanopies from "@/shared/components/sections/SectionCanopies.astro"
import SectionComplements from "@/shared/components/sections/SectionComplements.astro"
import MapProjects from "@/shared/components/MapProjects"
import LogoFepWhite from "@/shared/components/logos/LogoFepWhite.astro";
import SectionPartnerLogos from "@/shared/components/sections/SectionPartnerLogos.astro";
import HexagonCupLogoWhite from "@/shared/components/logos/LogoHexagonCupWhite.astro";
import { getI18N, getCurrentLocale, getCategoryByLanguage } from "@/shared/i18n"
import Gallery from "../Gallery.astro"
import NewsList from "../NewsList.astro"
import SectionGraphicProcess from "@/shared/components/sections/SectionGraphicProcess.astro"
import SectionInfiniteScroll from "@/shared/components/sections/SectionInfiniteScroll.astro"
import { type Photo } from "@/types/types.ts";

interface Props {
  language: string,
  projectsGallery: Photo[]
}

const { language, projectsGallery } = Astro.props
const i18n = getI18N({ language })
const currentLocale = getCurrentLocale({language})
const category = getCategoryByLanguage({language})

const response = await fetch(`https://old.porticosport.es/wp-json/wp/v2/posts?categories=${category}&per_page=4&_embed`)
const posts = await response.json();
---

<Layout title={i18n.SEO_TITLE} description={i18n.SEO_DESCRIPTION} currentLocale={currentLocale} language={language}>
  <link
    rel="preload"
    href="/fonts/jura.woff2"
    as="font"
    type="font/woff2"
    crossorigin
    slot="preload"
  />

  <Video language={language} video="/portico-sport-video.webm" subtitle={i18n.HERO_SUBTITLE} title={i18n.HERO_TITLE} buttonUrl={i18n.ROUTES.CONTACT.URL} buttonText={i18n.VIDEO_BUTTON}>
    <div
      slot="bottom"
      class="absolute bottom-[10%] w-40 md:bottom-1/4 md:w-[200px] left-1/2 -translate-x-1/2 md:translate-x-0 md:left-10 z-10"
    >
      <div class="flex flex-col gap-2">
        <LogoFepWhite />
        <HexagonCupLogoWhite />
      </div>
    </div>
  </Video>
  <main>
    <SectionIntro language={language} />
    <SectionGraphicProcess language={language} />
    <SectionInfiniteScroll language={language} />
    <SectionCourts language={language} />
    <SectionCanopies
      video="/cubiertas-spot.webm"
      subtitle={i18n.CANOPIES_SECTION.SUBTITLE}
      title={i18n.CANOPIES_SECTION.TITLE}
      text={i18n.CANOPIES_SECTION.TEXT}
      buttonUrl={i18n.ROUTES.CANOPIES.URL}
      buttonText={i18n.CANOPIES_SECTION.BUTTON_TEXT}
    />
    <SectionBento language={language} />
    <MapProjects client:only />
    <Gallery
      id={i18n.ROUTES.PROJECTS.ID}
      heading={i18n.INFO.PROJECTS_TITLE}
      subheading={i18n.INFO.PROJECTS_TEXT}
      photos={projectsGallery}
      path="projects"
    />
    <div class="flex">
      <Button class="mx-auto" url={i18n.ROUTES.PROJECTS.URL} target="_self">{i18n.INFO.BUTTON_TEXT}</Button>
    </div>
    <SectionComplements language={language} />
    <SectionFactory language={language} />
    <NewsList language={language} posts={posts} />
    <SectionContact language={language} bgImage="/hexagon-contact-bg.webp" image="/pista-hexagon-contact.webp" />
    <SectionPartnerLogos />
  </main>

</Layout>