---
import Layout from "@/layouts/Layout.astro"
import HeroContainer from "@/components/HeroContainer.astro"
import Breadcrumb from "@/components/Breadcrumb.astro"
import Section from "@/components/Section.astro"
const { slug } = Astro.props

const response = await fetch(`https://porticosport.com/wp-json/wp/v2/posts?slug=${slug}&_embed`)
const post = await response.json()
const { title: {rendered}, yoast_head_json: {title, description}, content: {rendered: content}, _embedded } = post[0]
const { source_url: image, alt_text: imgAlt } = _embedded["wp:featuredmedia"][0]
const finalTitle = rendered || title
---
<Layout title={finalTitle} description={description}>
  <HeroContainer img={image} imgAlt={imgAlt || finalTitle} heading={finalTitle} />
  <main class="pb-24 flex flex-col">
    <Breadcrumb
      crumbs={[
        { label: "Home", href: "/" },
        { label: "Blog", href: "/blog" },
        { label: finalTitle, href: `/blog/${slug}` },
      ]} />
    <Section>
      <article
        set:html={content}
      />
    </Section>
  </main>
</Layout>